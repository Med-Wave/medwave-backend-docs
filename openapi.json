{
  "openapi": "3.1.0",
  "info": {
    "title": "medwave-backend-rust",
    "description": "",
    "license": {
      "name": ""
    },
    "version": "0.1.0"
  },
  "paths": {
    "/auth/login": {
      "post": {
        "tags": [
          "authentication"
        ],
        "summary": "User login endpoint (OAuth2 Password Flow)",
        "description": "Authenticates a user with email and password credentials.\nReturns an access token for API authorization and sets a refresh token in an HTTP-only cookie.\n\nThe access token should be included in subsequent API requests using the Authorization header:\n`Authorization: Bearer {access_token}`\n\nThe refresh token is automatically stored in a secure HTTP-only cookie and can be used\nwith the `/auth/refresh` endpoint to obtain new access tokens without re-entering credentials.",
        "operationId": "oauth2_token",
        "requestBody": {
          "description": "User credentials for authentication. Email must be valid and password must be between 3-20 characters.",
          "content": {
            "application/x-www-form-urlencoded": {
              "schema": {
                "$ref": "#/components/schemas/UserLoginRequest"
              },
              "example": {
                "email": "user@example.com",
                "password": "myPassword123"
              }
            }
          },
          "required": true
        },
        "responses": {
          "200": {
            "description": "Authentication successful - access token granted and refresh token set in cookie",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/OAuth2TokenResponse"
                },
                "example": {
                  "access_token": "eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9...",
                  "expires_in": 3600,
                  "token_type": "Bearer"
                }
              }
            }
          },
          "400": {
            "description": "Invalid request - validation failed (e.g., invalid email format)",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/JsonErrorResponse"
                },
                "example": {
                  "message": "Email is not valid",
                  "status": 400
                }
              }
            }
          },
          "401": {
            "description": "Authentication failed - invalid email or password",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/JsonErrorResponse"
                },
                "example": {
                  "message": "Invalid credentials",
                  "status": 401
                }
              }
            }
          }
        }
      }
    },
    "/auth/logout": {
      "post": {
        "tags": [
          "authentication"
        ],
        "summary": "User logout endpoint",
        "description": "Logs out the user by invalidating and clearing the refresh token cookie.\nAfter logout, the refresh token can no longer be used to obtain new access tokens.\n\n**Note:** The access token remains valid until it expires naturally. To immediately\nrevoke access, the client should delete the stored access token on their side.\n\nThis endpoint does not require an Authorization header but requires a valid\nrefresh_token cookie to be present.",
        "operationId": "logout",
        "responses": {
          "200": {
            "description": "Logout successful - refresh token cookie cleared"
          },
          "400": {
            "description": "No refresh token found - user may already be logged out",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/JsonErrorResponse"
                },
                "example": {
                  "message": "Invalid refresh token",
                  "status": 400
                }
              }
            }
          }
        }
      }
    },
    "/auth/refresh": {
      "post": {
        "tags": [
          "authentication"
        ],
        "summary": "Refresh token endpoint",
        "description": "Obtains a new access token using the refresh token stored in HTTP-only cookie.\nThis allows users to remain authenticated without re-entering credentials when\ntheir access token expires.\n\nThe refresh token is automatically read from the `refresh_token` HTTP-only cookie\nset during login or registration. A new access token and refresh token pair are issued.\n\n**Note:** This endpoint does not require an Authorization header since it uses\nthe refresh token from the cookie instead.",
        "operationId": "refresh_token",
        "responses": {
          "200": {
            "description": "Tokens refreshed successfully - new access token issued",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/OAuth2TokenResponse"
                },
                "example": {
                  "access_token": "eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9...",
                  "expires_in": 3600,
                  "token_type": "Bearer"
                }
              }
            }
          },
          "400": {
            "description": "Missing refresh token - no refresh_token cookie found",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/JsonErrorResponse"
                },
                "example": {
                  "message": "Invalid refresh token",
                  "status": 400
                }
              }
            }
          },
          "401": {
            "description": "Invalid or expired refresh token",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/JsonErrorResponse"
                },
                "example": {
                  "message": "Invalid refresh token",
                  "status": 401
                }
              }
            }
          }
        }
      }
    },
    "/auth/register": {
      "post": {
        "tags": [
          "authentication"
        ],
        "summary": "User registration endpoint",
        "description": "Creates a new user account with the provided information.\nUpon successful registration, the user is automatically authenticated and receives\nan access token and refresh token (in HTTP-only cookie), eliminating the need\nfor a separate login request.\n\n**Validation Requirements:**\n- Email: Must be valid format and not already registered\n- First name: 2-50 characters\n- Last name: 2-50 characters\n- Password: 8-100 characters for security\n- Password confirmation: Must match password field",
        "operationId": "register",
        "requestBody": {
          "description": "New user registration information with password confirmation",
          "content": {
            "application/json": {
              "schema": {
                "$ref": "#/components/schemas/UserRegisterRequest"
              },
              "example": {
                "email": "newuser@example.com",
                "first_name": "John",
                "last_name": "Doe",
                "password": "SecurePassword123!",
                "password_confirmation": "SecurePassword123!"
              }
            }
          },
          "required": true
        },
        "responses": {
          "201": {
            "description": "Registration successful - user created and authenticated",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/OAuth2TokenResponse"
                },
                "example": {
                  "access_token": "eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9...",
                  "expires_in": 3600,
                  "token_type": "Bearer"
                }
              }
            }
          },
          "400": {
            "description": "Validation failed - password mismatch or invalid input",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/JsonErrorResponse"
                },
                "example": {
                  "message": "Password confirmation does not match",
                  "status": 400
                }
              }
            }
          },
          "409": {
            "description": "User already exists - email is already registered",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/JsonErrorResponse"
                },
                "example": {
                  "message": "User with this email already exists",
                  "status": 409
                }
              }
            }
          }
        }
      }
    },
    "/health-check": {
      "get": {
        "tags": [
          "health-check"
        ],
        "summary": "Health check endpoint",
        "description": "Returns a simple health check response to verify the service is running.",
        "operationId": "unprotected_health_check",
        "responses": {
          "200": {
            "description": "Service is healthy",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/HealthResponse"
                }
              }
            }
          }
        }
      }
    },
    "/health-check-protected": {
      "get": {
        "tags": [
          "health-check"
        ],
        "summary": "Advanced health check endpoint",
        "description": "Returns a more detailed health check response with system information.",
        "operationId": "protected_health_check",
        "responses": {
          "200": {
            "description": "System is healthy with details",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/HealthInfo"
                }
              }
            }
          },
          "401": {
            "description": "Unauthorized - Invalid or missing JWT token"
          }
        },
        "security": [
          {
            "oauth2_token": []
          }
        ]
      }
    },
    "/sections": {
      "get": {
        "tags": [
          "section"
        ],
        "summary": "Get all accessible sections",
        "description": "Returns all sections accessible to the current user (user's own sections + superuser/global sections).\nSupports optional filtering by section name using case-insensitive partial matching.\n\n**Sections returned:**\n- Sections owned by the current user\n- Global sections owned by the superuser (read-only, must clone to modify)\n\n**Ordering:**\n- Superuser sections first, then user's own sections\n- Within each group, sorted alphabetically by title",
        "operationId": "handle_get_all_sections",
        "parameters": [
          {
            "name": "filter",
            "in": "query",
            "description": "Optional filter for section name (case-insensitive partial match)",
            "required": false,
            "schema": {
              "type": [
                "string",
                "null"
              ]
            },
            "example": "Chief"
          }
        ],
        "responses": {
          "200": {
            "description": "Sections retrieved successfully",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/SectionListResponse"
                }
              }
            }
          },
          "401": {
            "description": "Unauthorized",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/JsonErrorResponse"
                }
              }
            }
          }
        },
        "security": [
          {
            "oauth2_token": []
          }
        ]
      },
      "post": {
        "tags": [
          "section"
        ],
        "summary": "Create a new section",
        "description": "Creates a custom section definition that can be added to interview sessions.\nSections define different parts of a medical interview (e.g., Chief Complaint,\nHistory of Present Illness, Physical Examination).\n\n**Section Types:**\n- `history_taking`: For collecting patient history, symptoms, and background information\n- `physical_examination`: For documenting physical examination findings\n\nOnce created, sections can be:\n- Added to existing sessions\n- Included in custom templates\n- Reused across multiple interviews",
        "operationId": "handle_create_section",
        "requestBody": {
          "description": "Section definition with name, description, and type",
          "content": {
            "application/json": {
              "schema": {
                "$ref": "#/components/schemas/SectionCreateRequest"
              },
              "example": {
                "description": "Document the patient's primary reason for visit",
                "name": "Chief Complaint",
                "section_type": "history_taking"
              }
            }
          },
          "required": true
        },
        "responses": {
          "201": {
            "description": "Section created successfully",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/SectionCreateResponse"
                },
                "example": {
                  "section_uuid": "750e8400-e29b-41d4-a716-446655440002"
                }
              }
            }
          },
          "400": {
            "description": "Validation failed - invalid name length or description",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/JsonErrorResponse"
                },
                "example": {
                  "message": "Name must be between 1 and 255 characters",
                  "status": 400
                }
              }
            }
          },
          "401": {
            "description": "Unauthorized - invalid or missing JWT token",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/JsonErrorResponse"
                }
              }
            }
          }
        },
        "security": [
          {
            "oauth2_token": []
          }
        ]
      }
    },
    "/sections/{section_uuid}": {
      "put": {
        "tags": [
          "section"
        ],
        "summary": "Update a section",
        "description": "Updates an existing section. Only sections owned by the current user can be updated.\nSuperuser/global sections are read-only and must be cloned first to make modifications.\n\n**Authorization:**\n- User must own the section\n- Superuser sections return 403 Forbidden (clone first to modify)",
        "operationId": "handle_update_section",
        "parameters": [
          {
            "name": "section_uuid",
            "in": "path",
            "description": "UUID of the section to update",
            "required": true,
            "schema": {
              "type": "string",
              "format": "uuid"
            }
          }
        ],
        "requestBody": {
          "description": "Fields to update (all optional)",
          "content": {
            "application/json": {
              "schema": {
                "$ref": "#/components/schemas/SectionUpdateRequest"
              }
            }
          },
          "required": true
        },
        "responses": {
          "200": {
            "description": "Section updated successfully",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/SectionUpdateResponse"
                }
              }
            }
          },
          "400": {
            "description": "Validation failed",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/JsonErrorResponse"
                }
              }
            }
          },
          "401": {
            "description": "Unauthorized",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/JsonErrorResponse"
                }
              }
            }
          },
          "403": {
            "description": "Cannot modify superuser section or not owner",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/JsonErrorResponse"
                }
              }
            }
          },
          "404": {
            "description": "Section not found",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/JsonErrorResponse"
                }
              }
            }
          }
        },
        "security": [
          {
            "oauth2_token": []
          }
        ]
      },
      "delete": {
        "tags": [
          "section"
        ],
        "summary": "Delete a section",
        "description": "Deletes an existing section. Only sections owned by the current user can be deleted.\nSuperuser/global sections cannot be deleted.\n\n**Authorization:**\n- User must own the section\n- Superuser sections return 403 Forbidden",
        "operationId": "handle_delete_section",
        "parameters": [
          {
            "name": "section_uuid",
            "in": "path",
            "description": "UUID of the section to delete",
            "required": true,
            "schema": {
              "type": "string",
              "format": "uuid"
            }
          }
        ],
        "responses": {
          "200": {
            "description": "Section deleted successfully",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/SectionDeleteResponse"
                }
              }
            }
          },
          "401": {
            "description": "Unauthorized",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/JsonErrorResponse"
                }
              }
            }
          },
          "403": {
            "description": "Cannot delete superuser section or not owner",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/JsonErrorResponse"
                }
              }
            }
          },
          "404": {
            "description": "Section not found",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/JsonErrorResponse"
                }
              }
            }
          }
        },
        "security": [
          {
            "oauth2_token": []
          }
        ]
      }
    },
    "/sections/{section_uuid}/clone": {
      "post": {
        "tags": [
          "section"
        ],
        "summary": "Clone a section",
        "description": "Creates an independent copy of an existing section. The cloned section is owned by\nthe requesting user and can be freely modified. This is the recommended way to\ncustomize superuser/global sections.\n\n**Use cases:**\n- Clone a superuser section to create a customizable copy\n- Duplicate one of your own sections as a starting point\n\n**Behavior:**\n- Creates a new section with the same title, description, and type\n- The new section is owned by the requesting user\n- No reference to the original section is maintained (independent copy)",
        "operationId": "handle_clone_section",
        "parameters": [
          {
            "name": "section_uuid",
            "in": "path",
            "description": "UUID of the section to clone",
            "required": true,
            "schema": {
              "type": "string",
              "format": "uuid"
            }
          }
        ],
        "responses": {
          "201": {
            "description": "Section cloned successfully",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/SectionCloneResponse"
                },
                "example": {
                  "section_uuid": "850e8400-e29b-41d4-a716-446655440003"
                }
              }
            }
          },
          "401": {
            "description": "Unauthorized",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/JsonErrorResponse"
                }
              }
            }
          },
          "404": {
            "description": "Section not found or not accessible",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/JsonErrorResponse"
                }
              }
            }
          }
        },
        "security": [
          {
            "oauth2_token": []
          }
        ]
      }
    },
    "/sessions": {
      "post": {
        "tags": [
          "session"
        ],
        "summary": "Create a new interview session",
        "description": "Creates a new medical interview session based on a predefined template.\nThe template determines which sections (e.g., History Taking, Physical Examination)\nwill be included in the session.\n\nAfter creation, the session can be populated with data through:\n- Audio transcription endpoints\n- Manual section updates\n- WebSocket real-time transcription\n\n**Timezone Support:** Provide the `X-Client-Timezone` header with an IANA timezone name\n(e.g., \"America/New_York\", \"Asia/Jakarta\") to set the session title in your local timezone.",
        "operationId": "handle_create_session",
        "parameters": [
          {
            "name": "X-Client-Timezone",
            "in": "header",
            "description": "IANA timezone name for timestamp formatting (e.g., 'America/New_York', 'Asia/Jakarta'). If not provided or invalid, defaults to UTC.",
            "required": false,
            "schema": {
              "type": [
                "string",
                "null"
              ]
            },
            "example": "America/New_York"
          }
        ],
        "requestBody": {
          "description": "Template UUID to base the new session on",
          "content": {
            "application/json": {
              "schema": {
                "$ref": "#/components/schemas/SessionCreateRequest"
              },
              "example": {
                "template_uuid": "850e8400-e29b-41d4-a716-446655440003"
              }
            }
          },
          "required": true
        },
        "responses": {
          "201": {
            "description": "Session created successfully with sections from template",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/SessionCreateResponse"
                },
                "example": {
                  "session_uuid": "650e8400-e29b-41d4-a716-446655440001"
                }
              }
            }
          },
          "400": {
            "description": "Invalid request - template UUID not provided or invalid",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/JsonErrorResponse"
                },
                "example": {
                  "message": "Invalid template UUID",
                  "status": 400
                }
              }
            }
          },
          "401": {
            "description": "Unauthorized - invalid or missing JWT token",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/JsonErrorResponse"
                }
              }
            }
          },
          "404": {
            "description": "Template not found",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/JsonErrorResponse"
                }
              }
            }
          }
        },
        "security": [
          {
            "oauth2_token": []
          }
        ]
      }
    },
    "/sessions/my": {
      "get": {
        "tags": [
          "session"
        ],
        "summary": "Get user's sessions",
        "description": "Retrieves a list of all sessions belonging to the authenticated user.\nEach session includes summary information (title, duration, timestamps)\nbut not detailed section data. Use the GET /sessions/{session_uuid}\nendpoint to retrieve full details for a specific session.\n\nSessions are returned in order of creation (most recent first).",
        "operationId": "handle_get_user_sessions",
        "responses": {
          "200": {
            "description": "User's sessions retrieved successfully",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/SessionListResponse"
                },
                "example": {
                  "sessions": [
                    {
                      "created_at": "2024-01-15T10:30:00Z",
                      "document": "Brief summary...",
                      "duration": 1800,
                      "title": "Patient Interview - January 15, 2024",
                      "updated_at": "2024-01-15T11:00:00Z",
                      "user_uuid": "550e8400-e29b-41d4-a716-446655440000",
                      "uuid": "650e8400-e29b-41d4-a716-446655440001"
                    }
                  ]
                }
              }
            }
          },
          "401": {
            "description": "Unauthorized - invalid or missing JWT token",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/JsonErrorResponse"
                }
              }
            }
          }
        },
        "security": [
          {
            "oauth2_token": []
          }
        ]
      }
    },
    "/sessions/{session_uuid}": {
      "get": {
        "tags": [
          "session"
        ],
        "summary": "Get session details",
        "description": "Retrieves complete information about a specific session including:\n- Session metadata (title, transcription, duration, timestamps)\n- All associated sections with their details\n- Bullet points extracted for each section\n- Section completion status\n\nThis provides a comprehensive view of the entire interview session.",
        "operationId": "handle_get_session",
        "parameters": [
          {
            "name": "session_uuid",
            "in": "path",
            "description": "Unique identifier of the session to retrieve",
            "required": true,
            "schema": {
              "type": "string",
              "format": "uuid"
            },
            "example": "650e8400-e29b-41d4-a716-446655440001"
          }
        ],
        "responses": {
          "200": {
            "description": "Session retrieved successfully with all sections and details",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/SessionGetResponse"
                }
              }
            }
          },
          "401": {
            "description": "Unauthorized - invalid or missing JWT token",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/JsonErrorResponse"
                }
              }
            }
          },
          "404": {
            "description": "Session not found - no session exists with the provided UUID",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/JsonErrorResponse"
                },
                "example": {
                  "message": "Session not found",
                  "status": 404
                }
              }
            }
          }
        },
        "security": [
          {
            "oauth2_token": []
          }
        ]
      },
      "patch": {
        "tags": [
          "session"
        ],
        "summary": "Update session metadata",
        "description": "Update metadata fields for the session.",
        "operationId": "handle_update_session_by_uuid",
        "parameters": [
          {
            "name": "session_uuid",
            "in": "path",
            "description": "Session UUID",
            "required": true,
            "schema": {
              "type": "string",
              "format": "uuid"
            }
          }
        ],
        "requestBody": {
          "content": {
            "application/json": {
              "schema": {
                "$ref": "#/components/schemas/SessionUpdateRequest"
              }
            }
          },
          "required": true
        },
        "responses": {
          "200": {
            "description": "Session updated successfully",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/SessionUpdateResponse"
                }
              }
            }
          },
          "401": {
            "description": "Unauthorized",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/JsonErrorResponse"
                }
              }
            }
          },
          "404": {
            "description": "Session not found",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/JsonErrorResponse"
                }
              }
            }
          }
        },
        "security": [
          {
            "oauth2_token": []
          }
        ]
      }
    },
    "/sessions/{session_uuid}/extend-with-audio": {
      "post": {
        "tags": [
          "session"
        ],
        "summary": "Extend the session transcription with audio",
        "description": "Append new transcription to the session from the uploaded audio.",
        "operationId": "handle_extend_session_with_audio",
        "parameters": [
          {
            "name": "session_uuid",
            "in": "path",
            "description": "Session UUID",
            "required": true,
            "schema": {
              "type": "string",
              "format": "uuid"
            }
          }
        ],
        "requestBody": {
          "description": "Audio file to transcribe and extend session transcription with",
          "content": {
            "multipart/form-data": {
              "schema": {
                "$ref": "#/components/schemas/SessionSectionUpdateWithAudioRequest"
              }
            }
          },
          "required": true
        },
        "responses": {
          "200": {
            "description": "Session transcription extended successfully with audio",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/SessionGetResponse"
                }
              }
            }
          },
          "400": {
            "description": "Invalid request or audio format",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/JsonErrorResponse"
                }
              }
            }
          },
          "401": {
            "description": "Unauthorized",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/JsonErrorResponse"
                }
              }
            }
          },
          "404": {
            "description": "Session not found",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/JsonErrorResponse"
                }
              }
            }
          }
        },
        "security": [
          {
            "oauth2_token": []
          }
        ]
      }
    },
    "/sessions/{session_uuid}/medical-note": {
      "post": {
        "tags": [
          "session"
        ],
        "summary": "Generate medical note",
        "description": "Generates a structured medical note document from the session transcription\nusing AI. The note is formatted according to standard medical documentation\npractices and includes sections such as:\n- Chief Complaint\n- History of Present Illness\n- Physical Examination\n- Assessment and Plan\n\nThis is typically used after completing the interview to create a formal\nmedical record document.",
        "operationId": "handle_generate_medical_note",
        "parameters": [
          {
            "name": "session_uuid",
            "in": "path",
            "description": "UUID of the session to generate medical note for",
            "required": true,
            "schema": {
              "type": "string",
              "format": "uuid"
            },
            "example": "650e8400-e29b-41d4-a716-446655440001"
          }
        ],
        "responses": {
          "200": {
            "description": "Medical note generated successfully",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/MedicalNoteResponse"
                },
                "example": {
                  "note": "Chief Complaint: Patient presents with headache for 3 days\n\nHistory of Present Illness: 45-year-old patient reports..."
                }
              }
            }
          },
          "401": {
            "description": "Unauthorized - invalid or missing JWT token",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/JsonErrorResponse"
                }
              }
            }
          },
          "404": {
            "description": "Session not found",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/JsonErrorResponse"
                },
                "example": {
                  "message": "Session not found",
                  "status": 404
                }
              }
            }
          }
        },
        "security": [
          {
            "oauth2_token": []
          }
        ]
      }
    },
    "/sessions/{session_uuid}/override-with-audio": {
      "patch": {
        "tags": [
          "session"
        ],
        "summary": "Override the session transcription with audio",
        "description": "Replace the session transcription with the uploaded audio recording.",
        "operationId": "handle_override_session_with_audio",
        "parameters": [
          {
            "name": "session_uuid",
            "in": "path",
            "description": "Session UUID",
            "required": true,
            "schema": {
              "type": "string",
              "format": "uuid"
            }
          }
        ],
        "requestBody": {
          "description": "Audio file to transcribe and override session transcription with",
          "content": {
            "multipart/form-data": {
              "schema": {
                "$ref": "#/components/schemas/SessionSectionUpdateWithAudioRequest"
              }
            }
          },
          "required": true
        },
        "responses": {
          "200": {
            "description": "Session transcription overridden successfully with audio",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/SessionSectionUpdateResponse"
                }
              }
            }
          },
          "400": {
            "description": "Invalid request or audio format",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/JsonErrorResponse"
                }
              }
            }
          },
          "401": {
            "description": "Unauthorized",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/JsonErrorResponse"
                }
              }
            }
          },
          "404": {
            "description": "Session not found",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/JsonErrorResponse"
                }
              }
            }
          }
        },
        "security": [
          {
            "oauth2_token": []
          }
        ]
      }
    },
    "/sessions/{session_uuid}/sections/{section_uuid}": {
      "post": {
        "tags": [
          "session"
        ],
        "summary": "Add a section to a session",
        "description": "Attach an existing section definition to the session, preventing duplicates.",
        "operationId": "handle_add_section_to_session",
        "parameters": [
          {
            "name": "session_uuid",
            "in": "path",
            "description": "Session UUID",
            "required": true,
            "schema": {
              "type": "string",
              "format": "uuid"
            }
          },
          {
            "name": "section_uuid",
            "in": "path",
            "description": "Section UUID",
            "required": true,
            "schema": {
              "type": "string",
              "format": "uuid"
            }
          }
        ],
        "responses": {
          "201": {
            "description": "Section added to session successfully",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/SessionSectionAddResponse"
                }
              }
            }
          },
          "401": {
            "description": "Unauthorized",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/JsonErrorResponse"
                }
              }
            }
          },
          "404": {
            "description": "Session or section not found",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/JsonErrorResponse"
                }
              }
            }
          },
          "409": {
            "description": "Section already exists in session",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/JsonErrorResponse"
                }
              }
            }
          }
        },
        "security": [
          {
            "oauth2_token": []
          }
        ]
      },
      "delete": {
        "tags": [
          "session"
        ],
        "summary": "Remove a section from a session",
        "description": "Remove the requested section from the session.",
        "operationId": "handle_delete_session_section_by_uuid",
        "parameters": [
          {
            "name": "session_uuid",
            "in": "path",
            "description": "Session UUID",
            "required": true,
            "schema": {
              "type": "string",
              "format": "uuid"
            }
          },
          {
            "name": "section_uuid",
            "in": "path",
            "description": "Section UUID",
            "required": true,
            "schema": {
              "type": "string",
              "format": "uuid"
            }
          }
        ],
        "responses": {
          "204": {
            "description": "Session section deleted successfully"
          },
          "401": {
            "description": "Unauthorized",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/JsonErrorResponse"
                }
              }
            }
          },
          "404": {
            "description": "Session section not found",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/JsonErrorResponse"
                }
              }
            }
          }
        },
        "security": [
          {
            "oauth2_token": []
          }
        ]
      },
      "patch": {
        "tags": [
          "session"
        ],
        "summary": "Update a section manually",
        "description": "Update the section content manually via JSON.",
        "operationId": "handle_update_session_section_by_uuid",
        "parameters": [
          {
            "name": "session_uuid",
            "in": "path",
            "description": "Session UUID",
            "required": true,
            "schema": {
              "type": "string",
              "format": "uuid"
            }
          },
          {
            "name": "section_uuid",
            "in": "path",
            "description": "Section UUID",
            "required": true,
            "schema": {
              "type": "string",
              "format": "uuid"
            }
          }
        ],
        "requestBody": {
          "content": {
            "application/json": {
              "schema": {
                "$ref": "#/components/schemas/SessionSectionUpdateRequest"
              }
            }
          },
          "required": true
        },
        "responses": {
          "200": {
            "description": "Session section updated successfully",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/SessionSectionUpdateResponse"
                }
              }
            }
          },
          "401": {
            "description": "Unauthorized",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/JsonErrorResponse"
                }
              }
            }
          },
          "404": {
            "description": "Session section not found",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/JsonErrorResponse"
                }
              }
            }
          }
        },
        "security": [
          {
            "oauth2_token": []
          }
        ]
      }
    },
    "/sessions/{session_uuid}/sections/{section_uuid}/update-with-audio": {
      "post": {
        "tags": [
          "session"
        ],
        "summary": "Update section with audio",
        "description": "Transcribe the provided audio and update the section with the extracted bullet points.",
        "operationId": "handle_update_session_section_with_audio_by_uuid",
        "parameters": [
          {
            "name": "session_uuid",
            "in": "path",
            "description": "UUID of the session containing the section",
            "required": true,
            "schema": {
              "type": "string",
              "format": "uuid"
            },
            "example": "650e8400-e29b-41d4-a716-446655440001"
          },
          {
            "name": "section_uuid",
            "in": "path",
            "description": "UUID of the section to update with audio",
            "required": true,
            "schema": {
              "type": "string",
              "format": "uuid"
            },
            "example": "750e8400-e29b-41d4-a716-446655440002"
          }
        ],
        "requestBody": {
          "description": "Audio file in multipart form. Field name must be 'audio_blob'. Supported formats: WAV, MP3, OGG, WebM, FLAC",
          "content": {
            "multipart/form-data": {
              "schema": {
                "$ref": "#/components/schemas/SessionSectionUpdateWithAudioRequest"
              }
            }
          },
          "required": true
        },
        "responses": {
          "200": {
            "description": "Section updated successfully with transcribed and analyzed audio content",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/SessionSectionUpdateResponse"
                },
                "example": {
                  "message": "Section updated with transcribed audio"
                }
              }
            }
          },
          "400": {
            "description": "Invalid request - missing audio data or unsupported audio format",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/JsonErrorResponse"
                },
                "example": {
                  "message": "No audio data provided",
                  "status": 400
                }
              }
            }
          },
          "401": {
            "description": "Unauthorized - invalid or missing JWT token",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/JsonErrorResponse"
                }
              }
            }
          },
          "404": {
            "description": "Session or section not found",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/JsonErrorResponse"
                },
                "example": {
                  "message": "Session section not found",
                  "status": 404
                }
              }
            }
          }
        },
        "security": [
          {
            "oauth2_token": []
          }
        ]
      }
    },
    "/sessions/{session_uuid}/summarize": {
      "post": {
        "tags": [
          "session"
        ],
        "summary": "Summarize session",
        "description": "Analyzes the complete session transcription and generates structured summaries\nfor all sections. This uses AI to extract key information and organize it into\nbullet points for each section type (History Taking, Physical Examination, etc.).\n\n**Use this endpoint to:**\n- Process a complete interview transcription\n- Generate organized bullet points for all sections\n- Prepare the session for medical note generation\n\nThis is typically called after completing an interview session to structure\nthe collected information.",
        "operationId": "handle_summarize_session",
        "parameters": [
          {
            "name": "session_uuid",
            "in": "path",
            "description": "UUID of the session to summarize",
            "required": true,
            "schema": {
              "type": "string",
              "format": "uuid"
            },
            "example": "650e8400-e29b-41d4-a716-446655440001"
          }
        ],
        "responses": {
          "200": {
            "description": "Session analyzed and summarized successfully - all sections updated with bullet points",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/SessionGetResponse"
                }
              }
            }
          },
          "401": {
            "description": "Unauthorized - invalid or missing JWT token",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/JsonErrorResponse"
                }
              }
            }
          },
          "404": {
            "description": "Session not found",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/JsonErrorResponse"
                },
                "example": {
                  "message": "Session not found",
                  "status": 404
                }
              }
            }
          }
        },
        "security": [
          {
            "oauth2_token": []
          }
        ]
      }
    },
    "/speech2text/transcribe": {
      "get": {
        "tags": [
          "speech2text"
        ],
        "summary": "Start a speech-to-text session",
        "description": "Open a secure WebSocket to stream microphone audio for the session and receive real-time transcripts and summaries.",
        "operationId": "handle_microphone_stream",
        "parameters": [
          {
            "name": "session_uuid",
            "in": "query",
            "description": "UUID of the session to attach the transcription stream to",
            "required": true,
            "schema": {
              "type": "string",
              "format": "uuid"
            },
            "example": "650e8400-e29b-41d4-a716-446655440001"
          }
        ],
        "responses": {
          "101": {
            "description": "WebSocket connection established"
          }
        },
        "security": [
          {
            "oauth2_token": []
          }
        ]
      }
    },
    "/templates": {
      "get": {
        "tags": [
          "template"
        ],
        "summary": "Get all accessible templates (lightweight list)",
        "description": "Returns a list of all templates accessible to the user (own + global).\nSorted: favorites first (A-Z), then non-favorites (A-Z).\nDoes not include sections - use GET /templates/{uuid} for full details.",
        "operationId": "handle_get_all_templates",
        "responses": {
          "200": {
            "description": "Templates retrieved successfully",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/TemplateInfoListResponse"
                }
              }
            }
          },
          "401": {
            "description": "Unauthorized",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/JsonErrorResponse"
                }
              }
            }
          }
        },
        "security": [
          {
            "oauth2_token": []
          }
        ]
      },
      "post": {
        "tags": [
          "template"
        ],
        "summary": "Create a new template",
        "operationId": "handle_create_template",
        "requestBody": {
          "content": {
            "application/json": {
              "schema": {
                "$ref": "#/components/schemas/TemplateCreateRequest"
              }
            }
          },
          "required": true
        },
        "responses": {
          "201": {
            "description": "Template created successfully",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/TemplateCreateResponse"
                }
              }
            }
          },
          "400": {
            "description": "Invalid request",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/JsonErrorResponse"
                }
              }
            }
          },
          "401": {
            "description": "Unauthorized",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/JsonErrorResponse"
                }
              }
            }
          }
        },
        "security": [
          {
            "oauth2_token": []
          }
        ]
      }
    },
    "/templates/{template_uuid}": {
      "get": {
        "tags": [
          "template"
        ],
        "summary": "Get a single template by UUID with full details",
        "description": "Returns template details including all sections, is_owner, and is_favorite fields.",
        "operationId": "handle_get_template_by_uuid",
        "parameters": [
          {
            "name": "template_uuid",
            "in": "path",
            "description": "Template UUID",
            "required": true,
            "schema": {
              "type": "string",
              "format": "uuid"
            }
          }
        ],
        "responses": {
          "200": {
            "description": "Template retrieved successfully",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/TemplateDetailResponse"
                }
              }
            }
          },
          "401": {
            "description": "Unauthorized",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/JsonErrorResponse"
                }
              }
            }
          },
          "404": {
            "description": "Template not found or access denied",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/JsonErrorResponse"
                }
              }
            }
          }
        },
        "security": [
          {
            "oauth2_token": []
          }
        ]
      },
      "put": {
        "tags": [
          "template"
        ],
        "summary": "Update a template",
        "operationId": "handle_update_template",
        "parameters": [
          {
            "name": "template_uuid",
            "in": "path",
            "description": "Template UUID to update",
            "required": true,
            "schema": {
              "type": "string",
              "format": "uuid"
            }
          }
        ],
        "requestBody": {
          "content": {
            "application/json": {
              "schema": {
                "$ref": "#/components/schemas/TemplateUpdateRequest"
              }
            }
          },
          "required": true
        },
        "responses": {
          "200": {
            "description": "Template updated successfully",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/TemplateUpdateResponse"
                }
              }
            }
          },
          "400": {
            "description": "Invalid request",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/JsonErrorResponse"
                }
              }
            }
          },
          "401": {
            "description": "Unauthorized",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/JsonErrorResponse"
                }
              }
            }
          },
          "404": {
            "description": "Template not found or access denied",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/JsonErrorResponse"
                }
              }
            }
          }
        },
        "security": [
          {
            "oauth2_token": []
          }
        ]
      },
      "delete": {
        "tags": [
          "template"
        ],
        "summary": "Delete a template",
        "operationId": "handle_delete_template",
        "parameters": [
          {
            "name": "template_uuid",
            "in": "path",
            "description": "Template UUID to delete",
            "required": true,
            "schema": {
              "type": "string",
              "format": "uuid"
            }
          }
        ],
        "responses": {
          "200": {
            "description": "Template deleted successfully",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/TemplateDeleteResponse"
                }
              }
            }
          },
          "401": {
            "description": "Unauthorized",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/JsonErrorResponse"
                }
              }
            }
          },
          "404": {
            "description": "Template not found or access denied",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/JsonErrorResponse"
                }
              }
            }
          }
        },
        "security": [
          {
            "oauth2_token": []
          }
        ]
      }
    },
    "/templates/{template_uuid}/clone": {
      "post": {
        "tags": [
          "template"
        ],
        "summary": "Clone an existing template",
        "operationId": "handle_clone_template",
        "parameters": [
          {
            "name": "template_uuid",
            "in": "path",
            "description": "Template UUID to clone",
            "required": true,
            "schema": {
              "type": "string",
              "format": "uuid"
            }
          }
        ],
        "responses": {
          "201": {
            "description": "Template cloned successfully",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/TemplateCreateResponse"
                }
              }
            }
          },
          "401": {
            "description": "Unauthorized",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/JsonErrorResponse"
                }
              }
            }
          },
          "404": {
            "description": "Template not found",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/JsonErrorResponse"
                }
              }
            }
          }
        },
        "security": [
          {
            "oauth2_token": []
          }
        ]
      }
    },
    "/templates/{template_uuid}/favorite": {
      "post": {
        "tags": [
          "template"
        ],
        "summary": "Add template to favorites",
        "description": "Marks a template as favorite for the current user.\nOnly templates owned by the user or global templates can be favorited.\nThis operation is idempotent.",
        "operationId": "handle_add_template_to_favorites",
        "parameters": [
          {
            "name": "template_uuid",
            "in": "path",
            "description": "Template UUID to favorite",
            "required": true,
            "schema": {
              "type": "string",
              "format": "uuid"
            }
          }
        ],
        "responses": {
          "200": {
            "description": "Template added to favorites",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/FavoriteResponse"
                }
              }
            }
          },
          "401": {
            "description": "Unauthorized",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/JsonErrorResponse"
                }
              }
            }
          },
          "404": {
            "description": "Template not found or access denied",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/JsonErrorResponse"
                }
              }
            }
          }
        },
        "security": [
          {
            "oauth2_token": []
          }
        ]
      },
      "delete": {
        "tags": [
          "template"
        ],
        "summary": "Remove template from favorites",
        "description": "Removes a template from the current user's favorites.\nThis operation is idempotent.",
        "operationId": "handle_remove_template_from_favorites",
        "parameters": [
          {
            "name": "template_uuid",
            "in": "path",
            "description": "Template UUID to unfavorite",
            "required": true,
            "schema": {
              "type": "string",
              "format": "uuid"
            }
          }
        ],
        "responses": {
          "200": {
            "description": "Template removed from favorites",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/FavoriteResponse"
                }
              }
            }
          },
          "401": {
            "description": "Unauthorized",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/JsonErrorResponse"
                }
              }
            }
          }
        },
        "security": [
          {
            "oauth2_token": []
          }
        ]
      }
    },
    "/templates/{template_uuid}/sections": {
      "post": {
        "tags": [
          "template"
        ],
        "summary": "Add a section to a template",
        "description": "Adds an existing section to a template. The section is added at the end of the template\nwith an automatically assigned display_order (max existing + 1).\n\n**Authorization:**\n- User must own the template\n\n**Validations:**\n- Section must exist\n- Section cannot already be in the template (no duplicates)",
        "operationId": "handle_add_section_to_template",
        "parameters": [
          {
            "name": "template_uuid",
            "in": "path",
            "description": "Template UUID to add section to",
            "required": true,
            "schema": {
              "type": "string",
              "format": "uuid"
            }
          }
        ],
        "requestBody": {
          "description": "Section to add to the template",
          "content": {
            "application/json": {
              "schema": {
                "$ref": "#/components/schemas/TemplateSectionAddRequest"
              }
            }
          },
          "required": true
        },
        "responses": {
          "201": {
            "description": "Section added to template successfully",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/TemplateSectionAddResponse"
                }
              }
            }
          },
          "401": {
            "description": "Unauthorized",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/JsonErrorResponse"
                }
              }
            }
          },
          "403": {
            "description": "User does not own the template",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/JsonErrorResponse"
                }
              }
            }
          },
          "404": {
            "description": "Template or section not found",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/JsonErrorResponse"
                }
              }
            }
          },
          "409": {
            "description": "Section is already in the template",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/JsonErrorResponse"
                }
              }
            }
          }
        },
        "security": [
          {
            "oauth2_token": []
          }
        ]
      }
    },
    "/templates/{template_uuid}/sections/{section_uuid}": {
      "delete": {
        "tags": [
          "template"
        ],
        "summary": "Remove a section from a template",
        "description": "Removes the association between a section and a template. This does NOT delete the section\nitself - only breaks the association.\n\n**Authorization:**\n- User must own the template",
        "operationId": "handle_remove_section_from_template",
        "parameters": [
          {
            "name": "template_uuid",
            "in": "path",
            "description": "Template UUID",
            "required": true,
            "schema": {
              "type": "string",
              "format": "uuid"
            }
          },
          {
            "name": "section_uuid",
            "in": "path",
            "description": "Section UUID to remove from template",
            "required": true,
            "schema": {
              "type": "string",
              "format": "uuid"
            }
          }
        ],
        "responses": {
          "200": {
            "description": "Section removed from template successfully",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/TemplateSectionRemoveResponse"
                }
              }
            }
          },
          "401": {
            "description": "Unauthorized",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/JsonErrorResponse"
                }
              }
            }
          },
          "403": {
            "description": "User does not own the template",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/JsonErrorResponse"
                }
              }
            }
          },
          "404": {
            "description": "Template not found or section not in template",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/JsonErrorResponse"
                }
              }
            }
          }
        },
        "security": [
          {
            "oauth2_token": []
          }
        ]
      }
    },
    "/users/me": {
      "get": {
        "tags": [
          "user"
        ],
        "summary": "Get current user profile",
        "description": "Retrieves the complete profile information for the currently authenticated user.\nThis endpoint requires a valid JWT access token in the Authorization header.\n\n**Returns:**\n- User UUID (unique identifier)\n- First and last name\n- Email address\n- User role (user, admin, or superuser)\n- Account creation and last update timestamps",
        "operationId": "get_me",
        "responses": {
          "200": {
            "description": "User profile retrieved successfully",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/UserResponse"
                },
                "example": {
                  "created_at": "2024-01-15T10:30:00Z",
                  "email": "user@example.com",
                  "first_name": "John",
                  "last_name": "Doe",
                  "updated_at": "2024-01-20T14:45:00Z",
                  "user_role": "user",
                  "uuid": "550e8400-e29b-41d4-a716-446655440000"
                }
              }
            }
          },
          "401": {
            "description": "Unauthorized - invalid, expired, or missing JWT token",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/JsonErrorResponse"
                },
                "example": {
                  "message": "Unauthorized",
                  "status": 401
                }
              }
            }
          }
        },
        "security": [
          {
            "oauth2_token": []
          }
        ]
      },
      "patch": {
        "tags": [
          "user"
        ],
        "summary": "Update current user profile",
        "description": "Updates the authenticated user's profile information. All fields are optional -\nonly the fields provided in the request body will be updated.\n\n**Updatable Fields:**\n- Email: Must be valid format and not registered by another user\n- First name: 2-50 characters\n- Last name: 2-50 characters\n\n**Note:** Password updates are not supported through this endpoint.\nAt least one field should be provided for a meaningful update.",
        "operationId": "patch_me",
        "requestBody": {
          "description": "Updated user profile fields (all optional)",
          "content": {
            "application/json": {
              "schema": {
                "$ref": "#/components/schemas/UserUpdateRequest"
              },
              "example": {
                "email": "newemail@example.com",
                "first_name": "Jane",
                "last_name": "Smith"
              }
            }
          },
          "required": true
        },
        "responses": {
          "200": {
            "description": "User profile updated successfully",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/UserResponse"
                },
                "example": {
                  "created_at": "2024-01-15T10:30:00Z",
                  "email": "newemail@example.com",
                  "first_name": "Jane",
                  "last_name": "Smith",
                  "updated_at": "2024-01-20T15:00:00Z",
                  "user_role": "user",
                  "uuid": "550e8400-e29b-41d4-a716-446655440000"
                }
              }
            }
          },
          "400": {
            "description": "Validation failed - invalid email format or field length",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/JsonErrorResponse"
                },
                "example": {
                  "message": "Email is not valid",
                  "status": 400
                }
              }
            }
          },
          "401": {
            "description": "Unauthorized - invalid, expired, or missing JWT token",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/JsonErrorResponse"
                },
                "example": {
                  "message": "Unauthorized",
                  "status": 401
                }
              }
            }
          },
          "409": {
            "description": "Email conflict - email is already registered by another user",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/JsonErrorResponse"
                },
                "example": {
                  "message": "Email already exists",
                  "status": 409
                }
              }
            }
          }
        },
        "security": [
          {
            "oauth2_token": []
          }
        ]
      }
    }
  },
  "components": {
    "schemas": {
      "DbError": {
        "oneOf": [
          {
            "type": "object",
            "required": [
              "Connection"
            ],
            "properties": {
              "Connection": {
                "type": "string"
              }
            }
          },
          {
            "type": "object",
            "required": [
              "QueryExecution"
            ],
            "properties": {
              "QueryExecution": {
                "type": "string"
              }
            }
          },
          {
            "type": "object",
            "required": [
              "Migration"
            ],
            "properties": {
              "Migration": {
                "type": "string"
              }
            }
          },
          {
            "type": "object",
            "required": [
              "Transaction"
            ],
            "properties": {
              "Transaction": {
                "type": "string"
              }
            }
          },
          {
            "type": "object",
            "required": [
              "Pool"
            ],
            "properties": {
              "Pool": {
                "type": "string"
              }
            }
          }
        ]
      },
      "FavoriteResponse": {
        "type": "object",
        "description": "Response for favorite operations",
        "required": [
          "message"
        ],
        "properties": {
          "message": {
            "type": "string"
          }
        }
      },
      "HealthInfo": {
        "type": "object",
        "description": "Detailed health check information\n\nProvides comprehensive system health status including version and timestamp.\nOnly available to authenticated users.",
        "required": [
          "status",
          "timestamp",
          "version",
          "service"
        ],
        "properties": {
          "service": {
            "type": "string",
            "description": "Service name identifier",
            "example": "medwave-backend"
          },
          "status": {
            "type": "string",
            "description": "Current health status of the service",
            "example": "healthy"
          },
          "timestamp": {
            "type": "string",
            "description": "Current timestamp in RFC 3339 format",
            "example": "2024-01-15T10:30:00Z"
          },
          "version": {
            "type": "string",
            "description": "Service version identifier",
            "example": "1.0.0"
          }
        }
      },
      "HealthResponse": {
        "type": "object",
        "description": "Basic health check response\n\nSimple response confirming the service is running and responsive.",
        "required": [
          "message"
        ],
        "properties": {
          "message": {
            "type": "string",
            "description": "Health check message",
            "example": "Hello World!"
          }
        }
      },
      "JsonErrorResponse": {
        "type": "object",
        "description": "JSON error response for API errors\n\nThis struct provides a consistent format for all error responses\nacross the application. It includes a request_id for tracing\nand a message explaining what went wrong.",
        "required": [
          "message",
          "status"
        ],
        "properties": {
          "message": {
            "type": "string",
            "description": "Human-readable error message explaining what happened"
          },
          "status": {
            "type": "integer",
            "format": "int32",
            "description": "Status code",
            "example": 400,
            "minimum": 0
          }
        }
      },
      "MedicalNoteResponse": {
        "type": "object",
        "description": "Response containing generated medical note\n\nThe medical note is an AI-generated document based on the session transcription.",
        "required": [
          "note"
        ],
        "properties": {
          "note": {
            "type": "string",
            "description": "Generated medical note document in text format",
            "example": "Chief Complaint: Patient presents with...\n\nHistory of Present Illness: ..."
          }
        }
      },
      "MultipartError": {
        "oneOf": [
          {
            "type": "object",
            "required": [
              "ProcessingFailed"
            ],
            "properties": {
              "ProcessingFailed": {
                "type": "string"
              }
            }
          },
          {
            "type": "object",
            "required": [
              "AudioReadFailed"
            ],
            "properties": {
              "AudioReadFailed": {
                "type": "string"
              }
            }
          },
          {
            "type": "string",
            "enum": [
              "NoAudioData"
            ]
          }
        ]
      },
      "OAuth2RefreshRequest": {
        "type": "object",
        "description": "Request body for OAuth2 token refresh (deprecated - use cookie-based refresh)\n\nNote: The current implementation uses HTTP-only cookies for refresh tokens.\nThis struct is kept for backwards compatibility but is not actively used.",
        "required": [
          "refresh_token"
        ],
        "properties": {
          "refresh_token": {
            "type": "string",
            "description": "Refresh token for obtaining a new access token",
            "example": "refresh_token_value_here"
          }
        }
      },
      "OAuth2TokenResponse": {
        "type": "object",
        "description": "OAuth2 token response following RFC 6749\n\nReturned after successful authentication or token refresh.\nThe access token should be used in the Authorization header as \"Bearer {access_token}\".\nThe refresh token is automatically stored in an HTTP-only cookie.",
        "required": [
          "access_token",
          "token_type",
          "expires_in"
        ],
        "properties": {
          "access_token": {
            "type": "string",
            "description": "JWT access token for API authorization\n\nUse this token in the Authorization header: \"Bearer {access_token}\"",
            "example": "eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJzdWIiOiIxMjM0NTY3ODkwIiwibmFtZSI6IkpvaG4gRG9lIiwiaWF0IjoxNTE2MjM5MDIyfQ.SflKxwRJSMeKKF2QT4fwpMeJf36POk6yJV_adQssw5c"
          },
          "expires_in": {
            "type": "integer",
            "format": "int64",
            "description": "Time in seconds until the access token expires\n\nAfter this period, use the refresh token endpoint to obtain a new access token.",
            "example": 3600,
            "minimum": 0
          },
          "token_type": {
            "$ref": "#/components/schemas/TokenTypeModel",
            "description": "Token type (always \"Bearer\" for access tokens)"
          }
        }
      },
      "OpenAIApiError": {
        "oneOf": [
          {
            "type": "string",
            "enum": [
              "SchemaSerializationError"
            ]
          },
          {
            "type": "string",
            "enum": [
              "ResponseFormatError"
            ]
          },
          {
            "type": "object",
            "required": [
              "RequestError"
            ],
            "properties": {
              "RequestError": {
                "type": "string"
              }
            }
          },
          {
            "type": "object",
            "required": [
              "HttpError"
            ],
            "properties": {
              "HttpError": {
                "type": "string"
              }
            }
          },
          {
            "type": "object",
            "required": [
              "ApiError"
            ],
            "properties": {
              "ApiError": {
                "type": "string"
              }
            }
          },
          {
            "type": "object",
            "required": [
              "JsonError"
            ],
            "properties": {
              "JsonError": {
                "type": "string"
              }
            }
          },
          {
            "type": "object",
            "required": [
              "FileError"
            ],
            "properties": {
              "FileError": {
                "type": "string"
              }
            }
          },
          {
            "type": "object",
            "required": [
              "StreamError"
            ],
            "properties": {
              "StreamError": {
                "type": "string"
              }
            }
          },
          {
            "type": "object",
            "required": [
              "InvalidArgument"
            ],
            "properties": {
              "InvalidArgument": {
                "type": "string"
              }
            }
          }
        ]
      },
      "Section": {
        "type": "object",
        "description": "Section definition\n\nDefines a reusable section template that can be added to sessions.",
        "required": [
          "uuid",
          "title",
          "section_type",
          "description",
          "created_at"
        ],
        "properties": {
          "created_at": {
            "type": "string",
            "format": "date",
            "description": "Timestamp when the section was created (RFC 3339 format)"
          },
          "description": {
            "type": "string",
            "description": "Description of what information should be collected in this section",
            "example": "Document the patient's primary reason for visit"
          },
          "is_blocked": {
            "type": [
              "boolean",
              "null"
            ],
            "description": "Whether this section is locked from editing",
            "example": false
          },
          "section_type": {
            "$ref": "#/components/schemas/SectionType",
            "description": "Type of section (history_taking or physical_examination)"
          },
          "title": {
            "type": "string",
            "description": "Name/title of the section",
            "example": "Chief Complaint"
          },
          "user_uuid": {
            "type": [
              "string",
              "null"
            ],
            "format": "uuid",
            "description": "UUID of the user who created this section (None for global sections)",
            "example": "550e8400-e29b-41d4-a716-446655440000"
          },
          "uuid": {
            "type": "string",
            "format": "uuid",
            "description": "Unique identifier for the section",
            "example": "750e8400-e29b-41d4-a716-446655440002"
          }
        }
      },
      "SectionCloneResponse": {
        "type": "object",
        "description": "Response after successfully cloning a section",
        "required": [
          "section_uuid"
        ],
        "properties": {
          "section_uuid": {
            "type": "string",
            "format": "uuid",
            "description": "UUID of the newly cloned section",
            "example": "850e8400-e29b-41d4-a716-446655440003"
          }
        }
      },
      "SectionCreateRequest": {
        "type": "object",
        "description": "Request body for creating a new section\n\nCreates a custom section that can be reused across multiple sessions.",
        "required": [
          "name",
          "description",
          "section_type"
        ],
        "properties": {
          "description": {
            "type": "string",
            "description": "Description of what this section is for\n\nMust be less than 500 characters.",
            "example": "Document patient allergies and current medications"
          },
          "name": {
            "type": "string",
            "description": "Name/title of the section\n\nMust be between 1 and 255 characters.",
            "example": "Allergies and Medications"
          },
          "section_type": {
            "$ref": "#/components/schemas/SectionType",
            "description": "Type of section being created"
          }
        }
      },
      "SectionCreateResponse": {
        "type": "object",
        "description": "Response after successfully creating a section",
        "required": [
          "section_uuid"
        ],
        "properties": {
          "section_uuid": {
            "type": "string",
            "format": "uuid",
            "description": "UUID of the newly created section",
            "example": "750e8400-e29b-41d4-a716-446655440002"
          }
        }
      },
      "SectionDeleteResponse": {
        "type": "object",
        "description": "Response after successfully deleting a section",
        "required": [
          "message"
        ],
        "properties": {
          "message": {
            "type": "string",
            "description": "Success message"
          }
        }
      },
      "SectionError": {
        "oneOf": [
          {
            "type": "object",
            "required": [
              "NotFound"
            ],
            "properties": {
              "NotFound": {
                "type": "string",
                "format": "uuid"
              }
            }
          },
          {
            "type": "string",
            "enum": [
              "SuperuserSectionReadOnly"
            ]
          },
          {
            "type": "string",
            "description": "User attempted to modify a section owned by another user.\nMaps to 404 instead of 403 to avoid leaking information about\nwhich sections exist but belong to other users.",
            "enum": [
              "NotOwner"
            ]
          }
        ]
      },
      "SectionListResponse": {
        "type": "object",
        "description": "Response containing a list of sections",
        "required": [
          "sections"
        ],
        "properties": {
          "sections": {
            "type": "array",
            "items": {
              "$ref": "#/components/schemas/Section"
            }
          }
        }
      },
      "SectionResponse": {
        "type": "object",
        "description": "Response containing section data",
        "required": [
          "section"
        ],
        "properties": {
          "section": {
            "$ref": "#/components/schemas/Section",
            "description": "Complete section information"
          }
        }
      },
      "SectionType": {
        "type": "string",
        "description": "Section type enumeration for medical interview sections\n\nDefines the different types of sections that can be included in an interview session.",
        "enum": [
          "history_taking",
          "physical_examination"
        ]
      },
      "SectionUpdateRequest": {
        "type": "object",
        "description": "Request body for updating a section",
        "properties": {
          "description": {
            "type": [
              "string",
              "null"
            ],
            "description": "New description of what this section is for (optional)",
            "example": "Updated description for documenting patient's primary reason for visit"
          },
          "name": {
            "type": [
              "string",
              "null"
            ],
            "description": "New name/title of the section (optional)",
            "example": "Updated Chief Complaint"
          },
          "section_type": {
            "oneOf": [
              {
                "type": "null"
              },
              {
                "$ref": "#/components/schemas/SectionType",
                "description": "New type of section (optional)"
              }
            ]
          }
        }
      },
      "SectionUpdateResponse": {
        "type": "object",
        "description": "Response after successfully updating a section",
        "required": [
          "message"
        ],
        "properties": {
          "message": {
            "type": "string",
            "description": "Success message"
          }
        }
      },
      "Session": {
        "type": "object",
        "description": "Medical interview session data\n\nRepresents a complete interview session with transcription and metadata.",
        "required": [
          "uuid",
          "user_uuid",
          "title",
          "transcription",
          "duration",
          "document",
          "created_at",
          "updated_at"
        ],
        "properties": {
          "created_at": {
            "type": "string",
            "format": "date",
            "description": "Timestamp when the session was created (RFC 3339 format)"
          },
          "document": {
            "type": "string",
            "description": "Generated document or summary from the session",
            "example": "Medical report summary..."
          },
          "duration": {
            "type": "integer",
            "format": "int32",
            "description": "Duration of the session in seconds",
            "example": 1800
          },
          "title": {
            "type": "string",
            "description": "Title or name of the session",
            "example": "Patient Interview - January 15, 2024"
          },
          "transcription": {
            "type": "string",
            "description": "Full transcription of the interview session",
            "example": "Doctor: Good morning. Patient: Good morning, doctor..."
          },
          "updated_at": {
            "type": "string",
            "format": "date",
            "description": "Timestamp when the session was last updated (RFC 3339 format)"
          },
          "user_uuid": {
            "type": "string",
            "format": "uuid",
            "description": "UUID of the user who owns this session",
            "example": "550e8400-e29b-41d4-a716-446655440000"
          },
          "uuid": {
            "type": "string",
            "format": "uuid",
            "description": "Unique identifier for the session",
            "example": "650e8400-e29b-41d4-a716-446655440001"
          }
        }
      },
      "SessionCreateRequest": {
        "type": "object",
        "description": "Request body for creating a new interview session\n\nCreates a new session based on a template with predefined sections.",
        "required": [
          "template_uuid"
        ],
        "properties": {
          "template_uuid": {
            "type": "string",
            "format": "uuid",
            "description": "UUID of the template to use for creating the session\n\nThe template defines which sections will be included in the session.",
            "example": "550e8400-e29b-41d4-a716-446655440000"
          }
        }
      },
      "SessionCreateResponse": {
        "type": "object",
        "description": "Response after successfully creating a session",
        "required": [
          "session_uuid"
        ],
        "properties": {
          "session_uuid": {
            "type": "string",
            "format": "uuid",
            "description": "UUID of the newly created session",
            "example": "650e8400-e29b-41d4-a716-446655440001"
          }
        }
      },
      "SessionError": {
        "oneOf": [
          {
            "type": "object",
            "required": [
              "NotFound"
            ],
            "properties": {
              "NotFound": {
                "type": "string",
                "format": "uuid"
              }
            }
          },
          {
            "type": "object",
            "required": [
              "InvalidUuid"
            ],
            "properties": {
              "InvalidUuid": {
                "type": "string"
              }
            }
          },
          {
            "type": "string",
            "enum": [
              "AccessDenied"
            ]
          },
          {
            "type": "object",
            "required": [
              "SectionNotFoundByUuid"
            ],
            "properties": {
              "SectionNotFoundByUuid": {
                "type": "array",
                "items": {
                  "type": "string",
                  "format": "uuid"
                },
                "maxItems": 2,
                "minItems": 2
              }
            }
          },
          {
            "type": "string",
            "enum": [
              "SectionNotFoundOrAccessDenied"
            ]
          },
          {
            "type": "object",
            "required": [
              "SectionAlreadyExists"
            ],
            "properties": {
              "SectionAlreadyExists": {
                "type": "array",
                "items": {
                  "type": "string",
                  "format": "uuid"
                },
                "maxItems": 2,
                "minItems": 2
              }
            }
          }
        ]
      },
      "SessionGetResponse": {
        "type": "object",
        "description": "Response containing complete session data with all sections",
        "required": [
          "session_data"
        ],
        "properties": {
          "session_data": {
            "$ref": "#/components/schemas/SessionWithSections",
            "description": "Complete session data including all associated sections"
          }
        }
      },
      "SessionInfo": {
        "type": "object",
        "description": "Session summary information\n\nProvides key session metadata without section details, useful for list views.",
        "required": [
          "uuid",
          "user_uuid",
          "title",
          "duration",
          "document",
          "created_at",
          "updated_at"
        ],
        "properties": {
          "created_at": {
            "type": "string",
            "format": "date",
            "description": "Timestamp when created (RFC 3339 format)"
          },
          "document": {
            "type": "string",
            "description": "Generated document or summary",
            "example": "Brief summary of the medical interview..."
          },
          "duration": {
            "type": "integer",
            "format": "int32",
            "description": "Duration of the session in seconds",
            "example": 1800
          },
          "title": {
            "type": "string",
            "description": "Title or name of the session",
            "example": "Patient Interview - January 15, 2024"
          },
          "updated_at": {
            "type": "string",
            "format": "date",
            "description": "Timestamp when last updated (RFC 3339 format)"
          },
          "user_uuid": {
            "type": "string",
            "format": "uuid",
            "description": "UUID of the user who owns this session",
            "example": "550e8400-e29b-41d4-a716-446655440000"
          },
          "uuid": {
            "type": "string",
            "format": "uuid",
            "description": "Unique identifier for the session",
            "example": "650e8400-e29b-41d4-a716-446655440001"
          }
        }
      },
      "SessionListResponse": {
        "type": "object",
        "description": "Response containing a list of user's sessions",
        "required": [
          "sessions"
        ],
        "properties": {
          "sessions": {
            "type": "array",
            "items": {
              "$ref": "#/components/schemas/SessionInfo"
            },
            "description": "Array of session information objects"
          }
        }
      },
      "SessionSection": {
        "type": "object",
        "description": "Session section with associated data\n\nRepresents a specific section within a session (e.g., History Taking, Physical Examination)\nwith collected bullet points from the interview.",
        "required": [
          "section_uuid",
          "session_uuid",
          "bullet_points",
          "is_blocked",
          "display_order",
          "updated_at"
        ],
        "properties": {
          "bullet_points": {
            "type": "array",
            "items": {
              "type": "string"
            },
            "description": "List of bullet points extracted from the interview for this section",
            "example": [
              "Chief complaint: headache for 3 days",
              "Pain level: 7/10",
              "No previous history of migraines"
            ]
          },
          "display_order": {
            "type": "integer",
            "format": "int32"
          },
          "is_blocked": {
            "type": "boolean",
            "description": "Whether this section is locked from further editing",
            "example": false
          },
          "section_uuid": {
            "type": "string",
            "format": "uuid",
            "description": "UUID of the section definition",
            "example": "750e8400-e29b-41d4-a716-446655440002"
          },
          "session_uuid": {
            "type": "string",
            "format": "uuid",
            "description": "UUID of the session this section belongs to",
            "example": "650e8400-e29b-41d4-a716-446655440001"
          },
          "updated_at": {
            "type": "string",
            "format": "date",
            "description": "Timestamp when the section was last updated (RFC 3339 format)"
          }
        }
      },
      "SessionSectionAddResponse": {
        "type": "object",
        "description": "Response after successfully adding a section to a session",
        "required": [
          "message"
        ],
        "properties": {
          "message": {
            "type": "string",
            "description": "Success message",
            "example": "Section added to session successfully"
          }
        }
      },
      "SessionSectionCompleted": {
        "type": "object",
        "description": "Completed section data with bullet points\n\nRepresents a completed section with its extracted bullet points.",
        "required": [
          "section_uuid",
          "bullet_points"
        ],
        "properties": {
          "bullet_points": {
            "type": "array",
            "items": {
              "type": "string"
            },
            "description": "List of extracted bullet points for this section",
            "example": [
              "Chief complaint identified",
              "History documented",
              "Symptoms recorded"
            ]
          },
          "section_uuid": {
            "type": "string",
            "format": "uuid",
            "description": "UUID of the completed section",
            "example": "750e8400-e29b-41d4-a716-446655440002"
          }
        }
      },
      "SessionSectionUpdateRequest": {
        "type": "object",
        "description": "Request body for updating a session section\n\nAll fields are optional - only provided fields will be updated.",
        "properties": {
          "bullet_points": {
            "type": [
              "array",
              "null"
            ],
            "items": {
              "type": "string"
            },
            "description": "Updated bullet points for the section\n\nReplaces existing bullet points if provided.",
            "example": [
              "Updated point 1",
              "Updated point 2",
              "Updated point 3"
            ]
          },
          "is_blocked": {
            "type": [
              "boolean",
              "null"
            ],
            "description": "Whether to lock this section from further editing",
            "example": false
          }
        }
      },
      "SessionSectionUpdateResponse": {
        "type": "object",
        "description": "Response after successfully updating a session section",
        "required": [
          "message"
        ],
        "properties": {
          "message": {
            "type": "string",
            "description": "Success or result message",
            "example": "Session section updated successfully"
          }
        }
      },
      "SessionSectionUpdateWithAudioRequest": {
        "type": "object",
        "description": "Multipart form data for updating session with audio\n\nUpload an audio file to be transcribed and added to the session.\nSupported audio formats: wav, mp3, ogg, webm, flac",
        "required": [
          "audio_blob"
        ],
        "properties": {
          "audio_blob": {
            "type": "string",
            "format": "binary",
            "description": "Audio file data in binary format\n\nThe audio will be transcribed using speech-to-text and processed for the session."
          }
        }
      },
      "SessionSectionUpdatedWithAudio": {
        "type": "object",
        "description": "Section data updated with audio transcription\n\nContains the updated section information after processing audio input.",
        "required": [
          "title",
          "bullet_points"
        ],
        "properties": {
          "bullet_points": {
            "type": "array",
            "items": {
              "type": "string"
            },
            "description": "Bullet points extracted from the audio transcription",
            "example": [
              "Patient reports headache for 3 days",
              "Pain intensity: moderate to severe",
              "No relief with over-the-counter medication"
            ]
          },
          "title": {
            "type": "string",
            "description": "Title of the updated section",
            "example": "History Taking"
          }
        }
      },
      "SessionSectionUpdatedWithAudioResponse": {
        "type": "object",
        "description": "Response after updating a section with audio transcription",
        "required": [
          "data"
        ],
        "properties": {
          "data": {
            "$ref": "#/components/schemas/SessionSectionUpdatedWithAudio",
            "description": "Updated section data with transcribed content"
          }
        }
      },
      "SessionSectionWithDetails": {
        "type": "object",
        "description": "Session section with complete details\n\nCombines the session-specific section data with the section definition details.",
        "required": [
          "session_section",
          "section"
        ],
        "properties": {
          "section": {
            "$ref": "#/components/schemas/Section",
            "description": "Section definition details (name, type, description)"
          },
          "session_section": {
            "$ref": "#/components/schemas/SessionSection",
            "description": "Session-specific section data (bullet points, status)"
          }
        }
      },
      "SessionSectionsCompletionResponse": {
        "type": "object",
        "description": "Response containing completion status of all session sections",
        "required": [
          "sections"
        ],
        "properties": {
          "sections": {
            "type": "array",
            "items": {
              "$ref": "#/components/schemas/SessionSectionCompleted"
            },
            "description": "List of completed sections with their bullet points"
          }
        }
      },
      "SessionUpdateRequest": {
        "type": "object",
        "description": "Request body for updating session metadata\n\nAll fields are optional - only provided fields will be updated.",
        "properties": {
          "duration": {
            "type": [
              "integer",
              "null"
            ],
            "format": "int32",
            "description": "Updated duration in seconds",
            "example": 2100
          },
          "title": {
            "type": [
              "string",
              "null"
            ],
            "description": "Updated title for the session",
            "example": "Updated Patient Interview - January 15, 2024"
          },
          "transcription": {
            "type": [
              "string",
              "null"
            ],
            "description": "Updated full transcription text",
            "example": "Doctor: Good afternoon. Patient: Good afternoon..."
          }
        }
      },
      "SessionUpdateResponse": {
        "type": "object",
        "description": "Response after successfully updating a session",
        "required": [
          "message"
        ],
        "properties": {
          "message": {
            "type": "string",
            "description": "Success message",
            "example": "Session updated successfully"
          }
        }
      },
      "SessionWithSections": {
        "type": "object",
        "description": "Complete session data with all sections\n\nProvides a comprehensive view of a session including all associated sections with details.",
        "required": [
          "session",
          "sections"
        ],
        "properties": {
          "sections": {
            "type": "array",
            "items": {
              "$ref": "#/components/schemas/SessionSectionWithDetails"
            },
            "description": "List of all sections in this session with their details"
          },
          "session": {
            "$ref": "#/components/schemas/Session",
            "description": "Base session data"
          }
        }
      },
      "TemplateCreateRequest": {
        "type": "object",
        "description": "Request body for creating a new template",
        "required": [
          "name",
          "sections"
        ],
        "properties": {
          "name": {
            "type": "string",
            "description": "Name of the template"
          },
          "sections": {
            "type": "array",
            "items": {
              "$ref": "#/components/schemas/TemplateSectionInput"
            },
            "description": "Sections to include in the template with their display order"
          }
        }
      },
      "TemplateCreateResponse": {
        "type": "object",
        "description": "Response after creating a template",
        "required": [
          "template_uuid"
        ],
        "properties": {
          "template_uuid": {
            "type": "string",
            "format": "uuid"
          }
        }
      },
      "TemplateDeleteResponse": {
        "type": "object",
        "description": "Response after deleting a template",
        "required": [
          "message"
        ],
        "properties": {
          "message": {
            "type": "string"
          }
        }
      },
      "TemplateDetailResponse": {
        "type": "object",
        "description": "Detailed template response with sections (no user_uuid)",
        "required": [
          "uuid",
          "template_name",
          "created_at",
          "updated_at",
          "is_owner",
          "is_favorite",
          "sections"
        ],
        "properties": {
          "created_at": {
            "type": "string",
            "format": "date"
          },
          "is_favorite": {
            "type": "boolean"
          },
          "is_owner": {
            "type": "boolean"
          },
          "sections": {
            "type": "array",
            "items": {
              "$ref": "#/components/schemas/TemplateSectionInfo"
            }
          },
          "template_name": {
            "type": "string"
          },
          "updated_at": {
            "type": "string",
            "format": "date"
          },
          "uuid": {
            "type": "string",
            "format": "uuid"
          }
        }
      },
      "TemplateError": {
        "oneOf": [
          {
            "type": "object",
            "required": [
              "NotFound"
            ],
            "properties": {
              "NotFound": {
                "type": "string",
                "format": "uuid"
              }
            }
          },
          {
            "type": "string",
            "enum": [
              "InvalidSections"
            ]
          },
          {
            "type": "object",
            "required": [
              "SectionNotFound"
            ],
            "properties": {
              "SectionNotFound": {
                "type": "string",
                "format": "uuid"
              }
            }
          },
          {
            "type": "object",
            "required": [
              "SectionAlreadyInTemplate"
            ],
            "properties": {
              "SectionAlreadyInTemplate": {
                "type": "string",
                "format": "uuid"
              }
            }
          },
          {
            "type": "object",
            "required": [
              "SectionNotInTemplate"
            ],
            "properties": {
              "SectionNotInTemplate": {
                "type": "string",
                "format": "uuid"
              }
            }
          },
          {
            "type": "string",
            "enum": [
              "NotOwner"
            ]
          }
        ]
      },
      "TemplateInfoListResponse": {
        "type": "object",
        "description": "Response containing a list of lightweight template info",
        "required": [
          "templates"
        ],
        "properties": {
          "templates": {
            "type": "array",
            "items": {
              "$ref": "#/components/schemas/TemplateInfoResponse"
            }
          }
        }
      },
      "TemplateInfoResponse": {
        "type": "object",
        "description": "Lightweight template info for list endpoint (no sections, no user_uuid)",
        "required": [
          "uuid",
          "template_name",
          "created_at",
          "updated_at",
          "is_owner",
          "is_favorite"
        ],
        "properties": {
          "created_at": {
            "type": "string",
            "format": "date"
          },
          "is_favorite": {
            "type": "boolean"
          },
          "is_owner": {
            "type": "boolean"
          },
          "template_name": {
            "type": "string",
            "description": "Name of the template",
            "example": "Standard Medical Interview"
          },
          "updated_at": {
            "type": "string",
            "format": "date",
            "description": "Timestamp when the template was last updated (RFC 3339 format)"
          },
          "uuid": {
            "type": "string",
            "format": "uuid"
          }
        }
      },
      "TemplateSectionAddRequest": {
        "type": "object",
        "description": "Request body for adding a section to a template",
        "required": [
          "section_uuid"
        ],
        "properties": {
          "section_uuid": {
            "type": "string",
            "format": "uuid",
            "description": "UUID of the section to add to the template"
          }
        }
      },
      "TemplateSectionAddResponse": {
        "type": "object",
        "description": "Response after adding a section to a template",
        "required": [
          "message",
          "display_order"
        ],
        "properties": {
          "display_order": {
            "type": "integer",
            "format": "int32",
            "description": "The display order assigned to the added section"
          },
          "message": {
            "type": "string",
            "description": "Success message"
          }
        }
      },
      "TemplateSectionInfo": {
        "type": "object",
        "description": "Section info for template detail response",
        "required": [
          "uuid",
          "title",
          "description",
          "section_type",
          "display_order",
          "created_at"
        ],
        "properties": {
          "created_at": {
            "type": "string",
            "format": "date"
          },
          "description": {
            "type": "string"
          },
          "display_order": {
            "type": "integer",
            "format": "int32"
          },
          "section_type": {
            "$ref": "#/components/schemas/SectionType"
          },
          "title": {
            "type": "string"
          },
          "uuid": {
            "type": "string",
            "format": "uuid"
          }
        }
      },
      "TemplateSectionInput": {
        "type": "object",
        "description": "Section with display order for template creation/update",
        "required": [
          "section_uuid",
          "display_order"
        ],
        "properties": {
          "display_order": {
            "type": "integer",
            "format": "int32",
            "description": "Display order of the section within the template (0-indexed)"
          },
          "section_uuid": {
            "type": "string",
            "format": "uuid",
            "description": "UUID of the section to add to template"
          }
        }
      },
      "TemplateSectionRemoveResponse": {
        "type": "object",
        "description": "Response after removing a section from a template",
        "required": [
          "message"
        ],
        "properties": {
          "message": {
            "type": "string",
            "description": "Success message"
          }
        }
      },
      "TemplateUpdateRequest": {
        "type": "object",
        "description": "Request body for updating an existing template",
        "properties": {
          "name": {
            "type": [
              "string",
              "null"
            ],
            "description": "New name of the template (optional)"
          },
          "sections": {
            "type": [
              "array",
              "null"
            ],
            "items": {
              "$ref": "#/components/schemas/TemplateSectionInput"
            },
            "description": "Updated sections with their display order (replaces all existing sections)"
          }
        }
      },
      "TemplateUpdateResponse": {
        "type": "object",
        "description": "Response after updating a template",
        "required": [
          "message"
        ],
        "properties": {
          "message": {
            "type": "string"
          }
        }
      },
      "TokenError": {
        "oneOf": [
          {
            "type": "object",
            "required": [
              "InvalidToken"
            ],
            "properties": {
              "InvalidToken": {
                "type": "string"
              }
            }
          },
          {
            "type": "string",
            "enum": [
              "InvalidRefreshToken"
            ]
          },
          {
            "type": "string",
            "enum": [
              "TokenExpired"
            ]
          },
          {
            "type": "string",
            "enum": [
              "MissingToken"
            ]
          },
          {
            "type": "string",
            "enum": [
              "InvalidWebsocketTokenFormat"
            ]
          },
          {
            "type": "object",
            "required": [
              "TokenCreationError"
            ],
            "properties": {
              "TokenCreationError": {
                "type": "string"
              }
            }
          }
        ]
      },
      "TokenTypeModel": {
        "type": "string",
        "description": "OAuth2 token type enumeration",
        "enum": [
          "Bearer",
          "Refresh"
        ]
      },
      "UserContext": {
        "type": "object",
        "description": "Safe user context for use in middleware and handlers.",
        "required": [
          "uuid",
          "email",
          "user_role"
        ],
        "properties": {
          "email": {
            "type": "string",
            "description": "User's email address"
          },
          "user_role": {
            "$ref": "#/components/schemas/UserRoleModel",
            "description": "User's role for authorization purposes"
          },
          "uuid": {
            "type": "string",
            "format": "uuid",
            "description": "Unique identifier for the user"
          }
        }
      },
      "UserError": {
        "type": "string",
        "enum": [
          "UserNotFound",
          "UserAlreadyExists",
          "InvalidPassword",
          "InvalidPasswordHash",
          "PasswordMismatch",
          "PasswordHashingFailed",
          "UserCreationFailed",
          "UserUpdateFailed"
        ]
      },
      "UserLoginRequest": {
        "type": "object",
        "description": "Request body for user login authentication\n\nThis structure is used for OAuth2 password flow authentication.\nSubmit as application/x-www-form-urlencoded content type.",
        "required": [
          "email",
          "password"
        ],
        "properties": {
          "email": {
            "type": "string",
            "description": "User's email address used for authentication\n\nMust be a valid email format.",
            "example": "user@example.com"
          },
          "password": {
            "type": "string",
            "description": "User's password\n\nMust be between 3 and 20 characters.",
            "example": "mySecurePassword123"
          }
        }
      },
      "UserRegisterRequest": {
        "type": "object",
        "description": "Request body for new user registration\n\nCreates a new user account with the provided credentials.\nUpon successful registration, returns an OAuth2 token for immediate authentication.",
        "required": [
          "email",
          "first_name",
          "last_name",
          "password",
          "password_confirmation"
        ],
        "properties": {
          "email": {
            "type": "string",
            "description": "User's email address (must be unique)\n\nMust be a valid email format and not already registered.",
            "example": "newuser@example.com"
          },
          "first_name": {
            "type": "string",
            "description": "User's first name\n\nMust be between 2 and 50 characters.",
            "example": "John"
          },
          "last_name": {
            "type": "string",
            "description": "User's last name\n\nMust be between 2 and 50 characters.",
            "example": "Doe"
          },
          "password": {
            "type": "string",
            "description": "User's password\n\nMust be between 8 and 100 characters for security.",
            "example": "SecurePassword123!"
          },
          "password_confirmation": {
            "type": "string",
            "description": "Password confirmation (must match password field)\n\nUsed to ensure the user correctly entered their desired password.",
            "example": "SecurePassword123!"
          }
        }
      },
      "UserResponse": {
        "type": "object",
        "description": "User profile information response\n\nContains complete user account details returned by the API.",
        "required": [
          "uuid",
          "first_name",
          "last_name",
          "email",
          "user_role",
          "created_at",
          "updated_at"
        ],
        "properties": {
          "created_at": {
            "type": "string",
            "description": "Timestamp when the user account was created (RFC 3339 format)",
            "example": "2024-01-15T10:30:00Z"
          },
          "email": {
            "type": "string",
            "description": "User's email address",
            "example": "user@example.com"
          },
          "first_name": {
            "type": "string",
            "description": "User's first name",
            "example": "John"
          },
          "last_name": {
            "type": "string",
            "description": "User's last name",
            "example": "Doe"
          },
          "updated_at": {
            "type": "string",
            "description": "Timestamp when the user account was last updated (RFC 3339 format)",
            "example": "2024-01-20T14:45:00Z"
          },
          "user_role": {
            "$ref": "#/components/schemas/UserRoleModel",
            "description": "User's role in the system (user, admin, or superuser)"
          },
          "uuid": {
            "type": "string",
            "format": "uuid",
            "description": "Unique identifier for the user",
            "example": "550e8400-e29b-41d4-a716-446655440000"
          }
        }
      },
      "UserRoleModel": {
        "type": "string",
        "description": "User role enumeration for authorization and access control",
        "enum": [
          "user",
          "admin",
          "superuser"
        ]
      },
      "UserUpdateRequest": {
        "type": "object",
        "description": "Request body for updating user profile information\n\nAll fields are optional - only provided fields will be updated.\nAt least one field should be provided for a meaningful update.",
        "properties": {
          "email": {
            "type": [
              "string",
              "null"
            ],
            "description": "New email address (optional)\n\nMust be a valid email format and not already registered by another user.",
            "example": "newemail@example.com"
          },
          "first_name": {
            "type": [
              "string",
              "null"
            ],
            "description": "New first name (optional)\n\nMust be between 2 and 50 characters if provided.",
            "example": "Jane"
          },
          "last_name": {
            "type": [
              "string",
              "null"
            ],
            "description": "New last name (optional)\n\nMust be between 2 and 50 characters if provided.",
            "example": "Smith"
          }
        }
      }
    },
    "securitySchemes": {
      "oauth2_token": {
        "type": "oauth2",
        "flows": {
          "password": {
            "tokenUrl": "http://localhost:8000/auth/login",
            "scopes": {}
          }
        },
        "description": "OAuth2 Password Flow"
      }
    }
  },
  "tags": [
    {
      "name": "authentication",
      "description": "Authentication API"
    },
    {
      "name": "user",
      "description": "User Management API"
    },
    {
      "name": "health-check",
      "description": "Health check API"
    },
    {
      "name": "speech2text",
      "description": "Speech to Text API"
    },
    {
      "name": "session",
      "description": "Session Management API"
    },
    {
      "name": "section",
      "description": "Section Management API"
    },
    {
      "name": "template",
      "description": "Template Management API"
    }
  ]
}